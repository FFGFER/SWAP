# Práctica 1 - Fernando Flores Garrido## Paso 1: Modificación del código del archivo hola.html para poder diferenciar las máquinas cuando probemos los balanceadores.> nano /var/www/html/hola.html![Modificación del código del archivo hola.html](img/Screenshot_4.jpg)# NginX## - Configuración de red de la máquina que usaremos para el paso 2.![Configuración de red de la máquina SWAP3 mostrada mediante ifconfig](img/SWAP3.jpg)## Paso 2.1: Instalación de NginX en una máquina preconfigurada sin servidor LAMP.> apt-get install nginx![Instalación de NginX mediante apt-get](img/Screenshot_2.jpg)## Paso 2.2: Puesta a punto de la configuración de NginX para funcionar con el algoritmo de balanceo round-robin.> nano /etc/nginx/conf.d/default.conf![Configuración del archivo default.conf](img/Screenshot_5.jpg)> nano /etc/nginx/nginx.conf![Configuración del archivo nginx.conf](img/Screenshot_6.jpg)> systemctl restart nginx (para aplicar los cambios efectuados en la configuración)![Reinicio de NginX mediante systemctl](img/Screenshot_7.jpg)## Paso 2.3: Prueba de funcionamiento del balanceador.![Recibimos el archivo hola.html desde la máquina SWAP1](img/Screenshot_8.jpg)![Recibimos el archivo hola.html desde la máquina SWAP2](img/Screenshot_9.jpg)## Paso 2.4: Puesta a punto de la configuración de NginX para funcionar con el algoritmo de balanceo con ponderación.Habría que configurar los archivos de manera similar que en el paso 2.2, salvo una ligera diferencia en el archivo /etc/nginx/conf.d/default.conf (concretamente en la sección upstream)> nano /etc/nginx/conf.d/default.conf![Configuración del archivo default.conf para que el algoritmo de balanceo sea con ponderación y no round-robin](img/Screenshot_10.jpg)> systemctl restart nginx (para aplicar los cambios efectuados en la configuración)![Reinicio de NginX mediante systemctl](img/Screenshot_7.jpg)# HaProxy## - Configuración de red de la máquina que usaremos para el paso 3.![Configuración de red de la máquina SWAP4 mostrada mediante ifconfig](img/SWAP4.jpg)## Paso 3.1: Instalación de HaProxy en una máquina preconfigurada sin servidor LAMP.> apt-get install haproxy![Instalación de HaProxy mediante apt-get](img/Screenshot_11.jpg)## Paso 3.2: Puesta a punto de la configuración de HaProxy para funcionar con el algoritmo de balanceo round-robin.> nano /etc/haproxy/haproxy.cfg![Configuración del archivo haproxy.conf](img/Screenshot_12.jpg)> /usr/sbin/haproxy -f /etc/haproxy/haproxy.cfg![Lanzamiento del servicio HaProxy en el sistema con la configuración que hemos editado](img/Screenshot_13.jpg)## Paso 3.3: Prueba de funcionamiento del balanceador.![Recibimos el archivo hola.html desde la máquina SWAP1](img/Screenshot_14.jpg)![Recibimos el archivo hola.html desde la máquina SWAP2](img/Screenshot_15.jpg)## Paso 3.4: Puesta a punto de la configuración de HaProxy para funcionar con el algoritmo de balanceo con ponderación.Habría que configurar el  archivo haproxy.cfg de manera similar que en el paso 3.2, salvo una ligera diferencia al final del archivo.> nano /etc/haproxy/haproxy.cfg![Configuración del archivo haproxy.cfg para que el algoritmo de balanceo sea con ponderación y no round-robin](img/Screenshot_16.jpg)> /etc/init.d/haproxy reload![Reinicio del servicio HaProxy](img/Screenshot_17.jpg)## Paso 4.1: Instalación de ApacheBench.> apt-get install apache2-utils![Instalación de ab mediante apt-get](img/Screenshot_18.jpg)## Paso 4.2: Recogida de 2 muestras (con diferente número de peticiones y nivel de concurrencia) por cada balanceador.> ab -n num_peticiones -c nivel_concurrencia http://IPMáquina/archivo![ab -n 10000 -c 10 http://192.168.56.30/index.html](img/Screenshot_19.jpg)![ab -n 50000 -c 50 http://192.168.56.30/index.html](img/Screenshot_20.jpg)![ab -n 10000 -c 10 http://192.168.56.35/index.html](img/Screenshot_21.jpg)![ab -n 50000 -c 50 http://192.168.56.35/index.html](img/Screenshot_22.jpg)Como se aprecia en las imágenes, el tiempo medio de servicio del balanceador haproxy es menor que el del balanceador nginx, tanto cuando el número de peticiones es 10000 y el nivel de concurrencia es 10, como cuando el número de peticiones ese 50000 y el nivel de concurrencia es 50.